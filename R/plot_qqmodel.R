#' Plot quantile-quantile (QQ) graphs from standardised residuals of linear models.
#'
#' This function takes a linear model (simple or mixed effects) and plots a QQ graph using \code{\link[ggplot2]{ggplot}} after running `fortify` or `fortify.merMod` to calculate standardised residuals.
#'
#' The function uses \code{plot_qqline}, which relies on \code{stat_qq} and \code{stat_qq_line} geometries (get help with \code{?stat_qq_line}).
#' The graph plots standardised residuals from the model on Y axis & theoretical quantiles on X axis.
#' Other 
#'
#' @param data a data table e.g. data.frame or tibble.
#' @param model name of a saved model generated by \code{simple_model} or \code{mixed_model}
#'
#' @return This function returns a \code{ggplot2} object.
#' @export plot_qqmodel
#' @import ggplot2
#' @importFrom lme4 fortify.merMod
#'
#' @examples
#' #Basic usage
#' m1 <- simple_model(data_2w_Festing, "GST", c("Treatment", "Strain"))
#' plot_qqmodel(m1)
#'

plot_qqmodel <- function(model, ...) {
  if (class(model) %in% c("lm")) {
    mr <- fortify(model)
    p <- plot_qqline(data = mr, 
                   ycol = .stdresid,
                   ...)}
  if (class(model) %in% c("lmerModLmerTest",
                     "lmerTest",
                     "lmerMod",
                     "merMod",
                     "glmerMod")) {
    mr <- fortify.merMod(model)
    p <- plot_qqline(data = mr, 
                   ycol = .scresid,
                   ...)}
  p
}

