<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot a scatter graph with matched shapes on a bar plot using three variables. — plot_3d_scatterbar • grafify</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plot a scatter graph with matched shapes on a bar plot using three variables. — plot_3d_scatterbar"><meta property="og:description" content="The functions plot_3d_scatterbar, plot_3d_scatterbox, plot_4d_scatterbar  and plot_4d_scatterbox are useful for plotting one-way or two-way ANOVA designs with randomised blocks or repeated measures. The blocks or subjects can be mapped to the shapes argument in both functions (up to 25 levels can be mapped to shapes; there will be an error if this number is exceeded). The 3d versions use the categorical variable (xcol) for grouping (e.g. one-way ANOVA designs), and 4d versions take an additional grouping variable (e.g. two-way ANOVA designs) that is passed to either boxes or bars argument."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-YV575FWSXZ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YV575FWSXZ');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">grafify</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ashenoy-cmbi/grafify/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot a scatter graph with matched shapes on a bar plot using three variables.</h1>
    <small class="dont-index">Source: <a href="https://github.com/ashenoy-cmbi/grafify/blob/HEAD/R/plot_3d_scatterbar.R" class="external-link"><code>R/plot_3d_scatterbar.R</code></a></small>
    <div class="hidden name"><code>plot_3d_scatterbar.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The functions <code>plot_3d_scatterbar</code>, <code><a href="plot_3d_scatterbox.html">plot_3d_scatterbox</a></code>, <code><a href="plot_4d_scatterbar.html">plot_4d_scatterbar</a></code>  and <code><a href="plot_4d_scatterbox.html">plot_4d_scatterbox</a></code> are useful for plotting one-way or two-way ANOVA designs with randomised blocks or repeated measures. The blocks or subjects can be mapped to the <code>shapes</code> argument in both functions (up to 25 levels can be mapped to <code>shapes</code>; there will be an error if this number is exceeded). The 3d versions use the categorical variable (<code>xcol</code>) for grouping (e.g. one-way ANOVA designs), and 4d versions take an additional grouping variable (e.g. two-way ANOVA designs) that is passed to either <code>boxes</code> or <code>bars</code> argument.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">plot_3d_scatterbar</span><span class="op">(</span>
  <span class="va">data</span>,
  <span class="va">xcol</span>,
  <span class="va">ycol</span>,
  <span class="va">shapes</span>,
  ewid <span class="op">=</span> <span class="fl">0.2</span>,
  symsize <span class="op">=</span> <span class="fl">2.5</span>,
  symthick <span class="op">=</span> <span class="fl">1</span>,
  jitter <span class="op">=</span> <span class="fl">0.1</span>,
  fontsize <span class="op">=</span> <span class="fl">20</span>,
  b_alpha <span class="op">=</span> <span class="fl">1</span>,
  s_alpha <span class="op">=</span> <span class="fl">1</span>,
  ColSeq <span class="op">=</span> <span class="cn">TRUE</span>,
  ColPal <span class="op">=</span> <span class="st">"all_grafify"</span>,
  ColRev <span class="op">=</span> <span class="cn">FALSE</span>,
  TextXAngle <span class="op">=</span> <span class="fl">0</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>a data table, e.g. data.frame or tibble.</p></dd>
<dt>xcol</dt>
<dd><p>name of the column with the categorical factor to be plotted on X axis.</p></dd>
<dt>ycol</dt>
<dd><p>name of the column with quantitative variable to plot on the Y axis.</p></dd>
<dt>shapes</dt>
<dd><p>name of the column with the second categorical factor, for example from a two-way ANOVA design.</p></dd>
<dt>ewid</dt>
<dd><p>width of error bars, default set to 0.2.</p></dd>
<dt>symsize</dt>
<dd><p>size of symbols, default set to 3.</p></dd>
<dt>symthick</dt>
<dd><p>size of outline of symbol lines (<code>stroke = 1.5</code>), default set to 1.5</p></dd>
<dt>jitter</dt>
<dd><p>extent of jitter (scatter) of symbols, default is 0.1. Increase to reduce symbol overlap, set to 0 for aligned symbols.</p></dd>
<dt>fontsize</dt>
<dd><p>parameter of <code>base_size</code> of fonts in <code>theme_classic</code>, default set to size 20.</p></dd>
<dt>b_alpha</dt>
<dd><p>fractional opacity of bars, default set to 1 (i.e. maximum opacity &amp; zero transparency).</p></dd>
<dt>s_alpha</dt>
<dd><p>fractional opacity of symbols, default set to 1 (i.e. maximum opacity &amp; zero transparency).</p></dd>
<dt>ColSeq</dt>
<dd><p>logical TRUE or FALSE. Default TRUE for sequential colours from chosen palette. Set to FALSE for distant colours, which will be applied using  <code>scale_fill_grafify2</code>.</p></dd>
<dt>ColPal</dt>
<dd><p>grafify colour palette to apply, default "all_grafify"; alternatives: "okabe_ito", "bright", "pale", "vibrant", "contrast", "muted" "dark", "light".</p></dd>
<dt>ColRev</dt>
<dd><p>whether to reverse order of colour choice, default F (FALSE); can be set to T (TRUE).</p></dd>
<dt>TextXAngle</dt>
<dd><p>orientation of text on X-axis; default 0 degrees. Change to 45 or 90 to remove overlapping text.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>This function returns a <code>ggplot2</code> object of class "gg" and "ggplot".</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>These functions rely on <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></code> with <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></code> (through <code>stat_summary</code>) or <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></code> geometries.</p>
<p>Variables other than the quantitative variable (<code>ycol</code>) will be automatically converted to categorical variables even if they are numeric in the data table.</p>
<p>Shapes are always plotted in black colour, and their opacity can be changed with the <code>s_alpha</code> argument and overlap can be reduced with the <code>jitter</code> argument. Other arguments are similar to other plot functions as briefly explained below.</p>
<p>Bars depict means using <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></code> with <code>geom = "bar", fun = "mean"</code> , and bar width is set to 0.7 (cannot be changed). Error bar width can be changed with the <code>ewid</code> argument.</p>
<p>Boxplot geometry uses <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></code> with <code>position = position_dodge(width = 0.9), width = 0.6</code>. The thick line within the boxplot depicts the median, the box the IQR (interquantile range) and the whiskers show 1.5*IQR.</p>
<p>In 4d versions, the two grouping variables (i.e. <code>xcol</code> and either <code>boxes</code> or <code>bars</code>) are passed to ggplot aesthetics through <code>group = interaction{ xcol, shapes}</code>.</p>
<p>Colours can be changed using <code>ColPal</code>, <code>ColRev</code> or <code>ColSeq</code> arguments.
<code>ColPal</code> can be one of the following: "okabe_ito", "dark", "light", "bright", "pale", "vibrant,  "muted" or "contrast".
<code>ColRev</code> (logical TRUE/FALSE) decides whether colours are chosen from first-to-last or last-to-first from within the chosen palette.
<code>ColSeq</code> (logical TRUE/FALSE) decides whether colours are picked by respecting the order in the palette or the most distant ones using <code><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></code>.</p>
<p>All four functions can be expanded further, for example with <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></code> or <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">#3d version for 1-way data with blocking</span></span>
<span class="r-in"><span class="fu"><a href="plot_3d_scatterbox.html">plot_3d_scatterbox</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_1w_death</span>, </span>
<span class="r-in">xcol <span class="op">=</span> <span class="va">Genotype</span>, ycol <span class="op">=</span> <span class="va">Death</span>, shapes <span class="op">=</span> <span class="va">Experiment</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_3d_scatterbar-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co">#compare above graph to</span></span>
<span class="r-in"><span class="fu"><a href="plot_scatterbox.html">plot_scatterbox</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_1w_death</span>, xcol <span class="op">=</span> <span class="va">Genotype</span>, ycol <span class="op">=</span> <span class="va">Death</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_3d_scatterbar-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#4d version for 2-way data with blocking</span></span>
<span class="r-in"><span class="fu"><a href="plot_4d_scatterbox.html">plot_4d_scatterbox</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_2w_Tdeath</span>, </span>
<span class="r-in">xcol <span class="op">=</span> <span class="va">Genotype</span>, </span>
<span class="r-in">ycol <span class="op">=</span> <span class="va">PI</span>, </span>
<span class="r-in">boxes <span class="op">=</span> <span class="va">Time</span>, </span>
<span class="r-in">shapes <span class="op">=</span> <span class="va">Experiment</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_3d_scatterbar-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="plot_4d_scatterbar.html">plot_4d_scatterbar</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_2w_Festing</span>, </span>
<span class="r-in">xcol <span class="op">=</span> <span class="va">Strain</span>, </span>
<span class="r-in">ycol <span class="op">=</span> <span class="va">GST</span>, </span>
<span class="r-in">bars <span class="op">=</span> <span class="va">Treatment</span>, </span>
<span class="r-in">shapes <span class="op">=</span> <span class="va">Block</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_3d_scatterbar-4.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Avinash R Shenoy.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

