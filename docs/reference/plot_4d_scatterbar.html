<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot a dot plot with matched shapes on a box plot using four variables. — plot_4d_scatterbar • grafify</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot a dot plot with matched shapes on a box plot using four variables. — plot_4d_scatterbar" />
<meta property="og:description" content="The functions plot_3d_scatterbar, plot_3d_scatterbox, plot_4d_scatterbar  and plot_4d_scatterbox allow 3d or 4d plots with 3 or 4 variables, respectively.
These four functions are useful for factorial ANOVA designs with randomised blocks or repeated-measures or for showing matched observations (e.g. depicting matched subjects or experiments).
They rely on ggplot with geom_point and geom_bar (through stat_summary) or geom_boxplot geometries." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YV575FWSXZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YV575FWSXZ');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">grafify</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ashenoy-cmbi/grafify/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot a dot plot with matched shapes on a box plot using four variables.</h1>
    <small class="dont-index">Source: <a href='https://github.com/ashenoy-cmbi/grafify/blob/master/R/plot_4d_scatterbar.R'><code>R/plot_4d_scatterbar.R</code></a></small>
    <div class="hidden name"><code>plot_4d_scatterbar.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The functions <code><a href='plot_3d_scatterbar.html'>plot_3d_scatterbar</a></code>, <code><a href='plot_3d_scatterbox.html'>plot_3d_scatterbox</a></code>, <code>plot_4d_scatterbar</code>  and <code><a href='plot_4d_scatterbox.html'>plot_4d_scatterbox</a></code> allow 3d or 4d plots with 3 or 4 variables, respectively.
These four functions are useful for factorial ANOVA designs with randomised blocks or repeated-measures or for showing matched observations (e.g. depicting matched subjects or experiments).
They rely on <code><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></code> with <code><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></code> and <code><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></code> (through <code>stat_summary</code>) or <code><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></code> geometries.</p>
    </div>

    <pre class="usage"><span class='fu'>plot_4d_scatterbar</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>xcol</span>,
  <span class='va'>ycol</span>,
  <span class='va'>bars</span>,
  <span class='va'>shapes</span>,
  symsize <span class='op'>=</span> <span class='fl'>2.5</span>,
  symthick <span class='op'>=</span> <span class='fl'>1</span>,
  ewid <span class='op'>=</span> <span class='fl'>0.2</span>,
  fontsize <span class='op'>=</span> <span class='fl'>20</span>,
  alpha <span class='op'>=</span> <span class='fl'>1</span>,
  ColPal <span class='op'>=</span> <span class='st'>"all_grafify"</span>,
  ColRev <span class='op'>=</span> <span class='cn'>F</span>,
  TextXAngle <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>a data table, e.g. data.frame or tibble.</p></td>
    </tr>
    <tr>
      <th>xcol</th>
      <td><p>name of the column with the categorical factor to plot on X axis. If column is numeric, enter as <code><a href='https://rdrr.io/r/base/factor.html'>factor(col)</a></code>.</p></td>
    </tr>
    <tr>
      <th>ycol</th>
      <td><p>name of the column to plot on quantitative variable on the Y axis.</p></td>
    </tr>
    <tr>
      <th>bars</th>
      <td><p>name of the column containing grouping within the factor plotted on X axis. Can be categorical or numeric X. If your table has numeric X and you want to plot as factor, enter <code>xcol = factor(name of colum)</code>.</p></td>
    </tr>
    <tr>
      <th>shapes</th>
      <td><p>name of the column that contains matched observations, e.g. subject IDs, experiment number etc.</p></td>
    </tr>
    <tr>
      <th>symsize</th>
      <td><p>size of symbols, default set to 3</p></td>
    </tr>
    <tr>
      <th>symthick</th>
      <td><p>size of outline of symbol lines (<code>stroke = 1.0</code>), default set to 1.0</p></td>
    </tr>
    <tr>
      <th>ewid</th>
      <td><p>width of error bars, default set to 0.2</p></td>
    </tr>
    <tr>
      <th>fontsize</th>
      <td><p>parameter of <code>base_size</code> of fonts in <code>theme_classic</code>, default set to size 20.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>fractional opacity of bars, default set to 1 (i.e. maximum opacity &amp; zero transparency)</p></td>
    </tr>
    <tr>
      <th>ColPal</th>
      <td><p>grafify colour palette to apply, default "all_grafify"; alternatives: "okabe_ito", "bright", "pale", "vibrant", "contrast", "muted" "dark", "light".</p></td>
    </tr>
    <tr>
      <th>ColRev</th>
      <td><p>whether to reverse order of colour choice, default F (FALSE); can be set to T (TRUE)</p></td>
    </tr>
    <tr>
      <th>TextXAngle</th>
      <td><p>orientation of text on X-axis; default 0 degrees. Change to 45 or 90 to remove overlapping text</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>This function returns a <code>ggplot2</code> object</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>These functions take a data table, X and Y variables, and a one or two more categorical variable for grouping together for boxes or bars, and the shape of symbols. These variables will be automatically converted to categorical variables even if numeric in the data table.
In <code>plot_3d_scatterbox</code> and <code>plot_3d_scatterbar</code> the third variable is called "shapes" and is mapped to both the box/bar fill colour and the shape of symbols.
In <code>plot_4d_scatterbox</code> and <code>plot_4d_scatterbar</code> the third variable is called "boxes" or "bars", respectively, is mapped to fill the colour of these geometries. The fourth variable "shapes" is mapped to the shape of symbols.
Shapes are always plotted in black colour, with 80% opacity (to enable overlapping data points to be seen; cannot be changed).</p>
<p>Scatter points are depicted using <code><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></code> with <code>position = position_jitterdodge(dodge.width = 0.8, jitter.width = 0.05)</code>, so shapes are jittered and dodged along the X variable.
Bars depict means using <code><a href='https://ggplot2.tidyverse.org/reference/stat_summary.html'>stat_summary</a></code> with <code>geom = "bar", fun = "mean"</code> , and bar width is set to 0.7 and cannot be changed.
Error bar width can be changed with the <code>ewid</code> argument.
Boxplot geometry uses <code><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></code> with <code>position = position_dodge(width = 0.9), width = 0.6</code>. The thick line depicts the median, the box the IQR and the whiskers 1.5*IQR.</p>
<p>The X and "shapes" variables are mapped with <code>group = interaction{ xcol, shapes}</code>.
In the 3d versions, the "shapes" variable is mapped to <code>scale_fill_grafify</code> aesthetic of bar/boxes, and in 4d versions, it is the "boxes" or "bars" argument that is mapped to the <code>scale_fill_grafify</code> call.</p>
<p>Colour palette can be changed using <code>ColPal</code> and colours reversed with <code>ColRev</code>.</p>
<p>Since v0.2.2, the scatter plots are jittered with <code>width = 0.05</code> to prevent overlapping and for consistency with <code>plot_3d_scatterbar</code> and <code>plot_3d_scatterbox</code>.
The opacity of the boxes/bars can be changed with the <code>alpha</code> argument.</p>
<p>In <code>plot_4d_scatterbox</code>, the third &amp; fourth variables can be the same (e.g. for one-way ANOVA with randomised blocks). Up to 25 levels can be mapped to "shapes".</p>
<p>All four functions can be expanded further, for example with <code><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></code> or <code><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#Basic usage can take up to 4 variables from the data table</span>
<span class='fu'>plot_4d_scatterbar</span><span class='op'>(</span><span class='va'>data_2w_Festing</span>, <span class='va'>Strain</span>, <span class='va'>GST</span>, <span class='va'>Treatment</span>, <span class='va'>Block</span><span class='op'>)</span>
</div><div class='img'><img src='plot_4d_scatterbar-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#bars and shapes can be the same factor if you want matched shapes for them</span>
<span class='fu'>plot_4d_scatterbar</span><span class='op'>(</span><span class='va'>data_doubling_time</span>, <span class='va'>Student</span>, <span class='va'>Doubling_time</span>, <span class='va'>Student</span>, <span class='va'>Experiment</span><span class='op'>)</span>
</div><div class='img'><img src='plot_4d_scatterbar-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Avinash Shenoy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


