<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot a dot plot with matched shapes on a box plot using four variables. — plot_4d_scatterbox • grafify</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot a dot plot with matched shapes on a box plot using four variables. — plot_4d_scatterbox" />
<meta property="og:description" content="The functions plot_3d_scatterbar, plot_3d_scatterbox and plot_4d_scatterbox allow 3d or 4d plots with 3 or 4 variables, respectively." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0H0ZJ63MW5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0H0ZJ63MW5');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">grafify</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ashenoy-cmbi/grafify/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot a dot plot with matched shapes on a box plot using four variables.</h1>
    <small class="dont-index">Source: <a href='https://github.com/ashenoy-cmbi/grafify/blob/master/R/plot_4d_scatterbox.R'><code>R/plot_4d_scatterbox.R</code></a></small>
    <div class="hidden name"><code>plot_4d_scatterbox.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The functions <code><a href='plot_3d_scatterbar.html'>plot_3d_scatterbar</a></code>, <code><a href='plot_3d_scatterbox.html'>plot_3d_scatterbox</a></code> and <code>plot_4d_scatterbox</code> allow 3d or 4d plots with 3 or 4 variables, respectively.</p>
    </div>

    <pre class="usage"><span class='fu'>plot_4d_scatterbox</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>xcol</span>,
  <span class='va'>ycol</span>,
  <span class='va'>boxes</span>,
  <span class='va'>shapes</span>,
  symsize <span class='op'>=</span> <span class='fl'>2</span>,
  symthick <span class='op'>=</span> <span class='fl'>1.5</span>,
  fontsize <span class='op'>=</span> <span class='fl'>20</span>,
  alpha <span class='op'>=</span> <span class='fl'>1</span>,
  ColPal <span class='op'>=</span> <span class='st'>"all_grafify"</span>,
  ColRev <span class='op'>=</span> <span class='cn'>F</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>a data table, e.g. data.frame or tibble.</p></td>
    </tr>
    <tr>
      <th>xcol</th>
      <td><p>name of the column with the categorical factor to plot on X axis. If column is numeric, enter as <code><a href='https://rdrr.io/r/base/factor.html'>factor(col)</a></code>.</p></td>
    </tr>
    <tr>
      <th>ycol</th>
      <td><p>name of the column to plot on quantitative variable on the Y axis.</p></td>
    </tr>
    <tr>
      <th>boxes</th>
      <td><p>name of the column containing grouping within the factor plotted on X axis. Can be categorical or numeric X. If your table has numeric X and you want to plot as factor, enter <code>xcol = factor(name of colum)</code>.</p></td>
    </tr>
    <tr>
      <th>shapes</th>
      <td><p>name of the column that contains matched observations, e.g. subject IDs, experiment number etc.</p></td>
    </tr>
    <tr>
      <th>symsize</th>
      <td><p>size of symbols, default set to 3</p></td>
    </tr>
    <tr>
      <th>symthick</th>
      <td><p>size of outline of symbol lines (<code>stroke = 1.5</code>), default set to 1.5</p></td>
    </tr>
    <tr>
      <th>fontsize</th>
      <td><p>parameter of <code>base_size</code> of fonts in <code>theme_classic</code>, default set to size 20.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>fractional opacity of boxes, default set to 1 (i.e. maximum opacity &amp; zero transparency)</p></td>
    </tr>
    <tr>
      <th>ColPal</th>
      <td><p>grafify colour palette to apply, default "all_grafify"; alternatives: "okabe_ito", "bright", "pale", "vibrant", "contrast", "muted" "dark", "light".</p></td>
    </tr>
    <tr>
      <th>ColRev</th>
      <td><p>whether to reverse order of colour choice, default F (FALSE); can be set to T (TRUE)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>This function returns a <code>ggplot2</code> object</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>These functions take a data table, X and Y variables, and a grouping variable "shapes" in the case of<code>plot_3d_scatterbox</code> and <code>plot_3d_scatterbar</code>, or two additional variables "boxes" and "shapes" in <code>plot_4d_scatterbox</code>. All three functions plot scatter plots with matched shapes (e.g. when you want to depict matched subjects or experiments). The grouping variable is useful to plot two-way factorial data or when there are more dimensions in the data table. These functions call <code><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></code> with <code><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></code> and <code><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></code> (actually through <code>stat_summary</code>) or <code><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></code> geometries.</p>
<p>Bars depict means using <code><a href='https://ggplot2.tidyverse.org/reference/stat_summary.html'>stat_summary</a></code> with <code>geom = "bar", fun = "mean"</code> , and scatter points are depicted using <code><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></code> with <code>position = position_jitterdodge(dodge.width = 0.8, jitter.width = 0.05)</code>, so shapes are jittered and dodged along the X variable.
The X and "shapes" variables are mapped with <code>group = interaction{ xcol, shapes}</code>. The xcol variable is mapped to the <code>fill</code> aesthetic of bar graph and <code>colour</code> aesthetic of scatterplot.
Fill and colour can be changed using <code>scale_fill_brewer</code> (or related) and <code>scale_colour_brewer</code> (or related) options. The "shapes" argument is plotted to the shape of the <code>geom_point</code>.
The "shapes" variable is mapped to the aesthetic <code>shape</code> of the scatterplot <code>geom_point</code> geometry.</p>
<p>Boxplot geometry uses <code><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></code> with <code>position = position_dodge(width = 0.9), width = 0.6</code>.</p>
<p>In <code>plot_4d_scatterbox</code>, the third variable is mapped to the boxplot and 4th to shapes. Both variables could be entered as the same as well. Up to 25 levels can be mapped to "shapes".</p>
<p>All three functions can be expanded further, for example with <code><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></code> or <code><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#Basic usage can take up to 4 variables from the data table</span>
<span class='fu'>plot_4d_scatterbox</span><span class='op'>(</span><span class='va'>data_cholesterol</span>, <span class='va'>Treatment</span>, <span class='va'>Cholesterol</span>, <span class='va'>Hospital</span>, <span class='va'>Subject</span><span class='op'>)</span>
</div><div class='img'><img src='plot_4d_scatterbox-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#boxes and shapes can be the same factor if you want matched shapes for them</span>
<span class='co'>#pay attention to which variable is assigned to boxes and which one to shapes</span>
<span class='co'>#try swapping them to get the best-looking graph</span>
<span class='fu'>plot_4d_scatterbox</span><span class='op'>(</span><span class='va'>data_doubling_time</span>, <span class='va'>Student</span>, <span class='va'>Doubling_time</span>, <span class='va'>Student</span>, <span class='va'>Experiment</span><span class='op'>)</span><span class='co'>#'</span>
</div><div class='img'><img src='plot_4d_scatterbox-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


