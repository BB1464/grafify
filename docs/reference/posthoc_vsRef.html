<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Post-hoc comparisons to a control or reference group. — posthoc_vsRef • grafify</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Post-hoc comparisons to a control or reference group. — posthoc_vsRef" />
<meta property="og:description" content="This function is a wrapper based on emmeans, and needs a model produced by simple_model (which calls lm) or a linear mixed effects model produced by mixed_model (which calls lmer). It also needs to know the fixed factors, which should match those in the model." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YV575FWSXZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YV575FWSXZ');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">grafify</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ashenoy-cmbi/grafify/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Post-hoc comparisons to a control or reference group.</h1>
    <small class="dont-index">Source: <a href='https://github.com/ashenoy-cmbi/grafify/blob/master/R/posthoc_vsRef.R'><code>R/posthoc_vsRef.R</code></a></small>
    <div class="hidden name"><code>posthoc_vsRef.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is a wrapper based on <code><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></code>, and needs a model produced by <code><a href='simple_model.html'>simple_model</a></code> (which calls <code><a href='https://rdrr.io/r/stats/lm.html'>lm</a></code>) or a linear mixed effects model produced by <code><a href='mixed_model.html'>mixed_model</a></code> (which calls <code><a href='https://rdrr.io/pkg/lmerTest/man/lmer.html'>lmer</a></code>). It also needs to know the fixed factors, which should match those in the model.</p>
    </div>

    <pre class="usage"><span class='fu'>posthoc_vsRef</span><span class='op'>(</span><span class='va'>Model</span>, <span class='va'>Factors</span>, Ref <span class='op'>=</span> <span class='fl'>1</span>, P_Adj <span class='op'>=</span> <span class='st'>"fdr"</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Model</th>
      <td><p>a model object fit using <code><a href='simple_model.html'>simple_model</a></code> or <code><a href='mixed_model.html'>mixed_model</a></code> (or <code><a href='https://rdrr.io/r/stats/lm.html'>lm</a></code> or <code><a href='https://rdrr.io/pkg/lmerTest/man/lmer.html'>lmer</a></code>).</p></td>
    </tr>
    <tr>
      <th>Factors</th>
      <td><p>Factors one or  more categorical variables, provided as a vector (see Examples), whose levels you wish to compare pairwise. Names of factors should match factors used to fit the model. When more than one factor is provided e.g. <code>Fixed_factor = c("A", "B")</code>, this function passes this on as <code>specs = A|B</code> (note the vertical | between the two factors) to <code><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></code>. The specification internally is set to <code>specs = trt.vs.ctrl, ref = 1</code> to compare each group in A to the reference first group in A, separately at each level of B.</p></td>
    </tr>
    <tr>
      <th>Ref</th>
      <td><p>the reference group provided as a number; default <code>ref = 1</code>.</p></td>
    </tr>
    <tr>
      <th>P_Adj</th>
      <td><p>P_Adj method for correcting P values for multiple comparisons. Default is set to false discovery rate ("fdr"), can be changed to "none", "tukey", "bonferroni", "sidak". See the <a href='https://cran.r-project.org/web/packages/emmeans/vignettes/confidence-intervals.html#adjust'>manual</a> for <code>emmeans</code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments for <code><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></code> such as <code>lmer.df</code> or others. See help for sophisticated models in <a href='https://cran.r-project.org/web/packages/emmeans/vignettes/sophisticated.html'>emmeans</a>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>returns the result of <code><a href='https://rdrr.io/pkg/emmeans/man/emmeans.html'>emmeans</a></code> contrasts.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function will generate <a href='https://cran.r-project.org/web/packages/emmeans/vignettes/comparisons.html#contrasts'>treatment vs control type of comparisons</a>, i.e. comparison of each level of a factor to a reference level, which is set by default to the first level in the factor (<code>ref = 1</code>).
By default, P values are corrected by the FDR method (which can be changed). If the model was fit by transforming the quantitative response variable using "log", "logit", "sqrt" etc., results will still be on the <a href='https://cran.r-project.org/web/packages/emmeans/vignettes/transformations.html#overview'>original scale</a>, i.e. <code>type = "response"</code> is the default. Data will be back-transformed (check results to confirm this), and for log or logit, <a href='https://cran.r-project.org/web/packages/emmeans/vignettes/comparisons.html#logs'>ratios will be compared</a>.
The first part of the <code>emmeans</code> results has the estimated marginal means, SE and CI (<code>$emmeans</code>), which are generated from the fitted model, and <strong>not</strong> the original data table. The second part has the results of the comparisons (<code>$contrasts</code>).</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#basic usage to compare against ref = 1</span>
<span class='co'>#posthoc_vsRef(DoublMod, "Student")</span>

<span class='co'>#to compare all students with student #9</span>
<span class='co'>#posthoc_vsRef(DoublMod, "Student", ref = 9)</span>

<span class='co'>#for comparison between hospital #1 to every other hospital, separately at levels of Treatment</span>
<span class='co'>#posthoc_vsRef(CholMod, c("Hospital", "Treatment"))</span>

<span class='co'>#for comparisons between reference group of treatment to every other group, </span>
<span class='co'>#listed separated at every level of Hospital</span>
<span class='co'>#posthoc_vsRef(CholMod, c("Treatment", "Hospital"))</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Avinash Shenoy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


